---
title: What&#39;s New in v2.0-alpha.20180212
toc: false
summary: Additions and changes in CockroachDB version v2.0-alpha.20180212 since version v2.0-alpha.20180129
---

Get future release notes emailed to you:

    <div class="hubspot-install-form install-form-1 clearfix">
        <script>
            hbspt.forms.create({
                css: '',
                cssClass: 'install-form',
                portalId: '1753393',
                formId: '39686297-81d2-45e7-a73f-55a596a8d5ff',
                formInstanceId: 1,
                target: '.install-form-1'
            });
        </script>
    </div>

### Downloads

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20180212.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20180212.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20180212.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-alpha.20180212.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

### General Changes

- debug commands now open RocksDB in
  read-only mode, making them faster and able to run in parallel. [#21778][#21778]

### Enterprise Edition Changes

- Enable backup/restore for sequences. This changes how sequences
  are stored in the KV layer, so existing sequences will need to be
  dropped and recreated. Since a sequence cannot be dropped while it
  is being used in a column's DEFAULT expression, those expressions
  will need to be dropped before the sequence is dropped, and recreated
  after the sequence is recreated. The `setval` function can be used to
  set the value of a sequence to what it was previously. [#21684][#21684]

### SQL Language Changes

- Allow casts between array types when a
  cast between parameter types is allowed. [#22338][#22338]
- scalar functions can now be used
  in FROM clauses. [#22314][#22314]
- significantly reduce the likelihood of serializable
  restarts seen by clients due to concurrent workloads. [#21140][#21140]
- add privilege checks on sequences [#22284][#22284]
- Add sequences to `cockroach dump` output [#21774][#21774]
- ON DELETE SET DEFAULT and ON UPDATE SET DEFAULT
  foreign key constraints actions are now fully supported [#22220][#22220]
- introduce SHOW GRANTS ON ROLE to list role
  memberships [#22205][#22205]
- JSON inverted indexes may now be specified in
  a CREATE TABLE statement. [#22217][#22217]
- Fixed a bug in cascading foreign reference actions
  such that which more than one cascading operation can occur per statement. As
  in, cascading from multiple deletes now works. [#21799][#21799]
- fix SHOW GRANTS with grantee but no targets. [#21864][#21864]
- ON UPDATE SET NULL foreign key constraints actions
  are now fully supported [#21767][#21767]
- Avoid planning queries on draining nodes. [#20450][#20450]
- Nodes that are gracefully shut down
  while participating in a distributed sql query wait up to
  `server.drain_max_wait` for the query to complete before shutting down. [#20450][#20450]
- allow collated strings in COPY
  Release note (enterprise change): allow collated strings in IMPORT

  Fixes #21858 [#21859][#21859]
- Fix reporting of errors from transactional schema
  changes: errors from DDL statements sent by a client as part of a
  transaction, but in a different query string than the final commit used
  to be silently swallowed. [#21829][#21829]
- ON DELETE SET NULL foreign key constraints actions
  are now fully supported [#21716][#21716]
- consider role memberships in permission checks [#21820][#21820]
- add `pg_catalog.pg_auth_members` table
  listing role memberships. [#21780][#21780]

### Command-Line Changes

- the table formatter `records` now properly
  indicates line continuations in multi-line rows for better
  compatibility with `psql`'s extended format. [#22325][#22325]
- the client-side option `show_times` is now
  always enabled when output goes to a terminal, not just when
  `display_format` is set to `pretty`. [#22326][#22326]
- when printing tabular results with
  `--format=sql`, the row count is printed in a SQL comment at the end. [#22327][#22327]
- tabular results where the column labels
  contain newline characters are now rendered properly. [#19306][#19306]
- CSV and TSV output have been improved:
  result rows that contain special characters are now quoted properly
  when formatted with `--pretty=csv` or `--pretty=tsv`. [#19306][#19306]
- The sql.drain_max_wait cluster setting has been
  added to provide control over the amount of time subsystems wait for
  in-progress work to finish when gracefully draining. [#20450][#20450]

### Admin UI Changes

- Allow long descriptions in the jobs table to be
  collapsed again after expanding. [#22221][#22221]
- Add an icon to indicate when job descriptions
  are shortened and expandable. [#22221][#22221]
- Add graphs for the "compaction queue",
  which automatically kicks off rocksdb compactions when substantial disk
  space could be reclaimed, to the Queues dashboard. [#22218][#22218]
- When there are dead nodes, show them first on
  the node list page, above the live nodes. [#22222][#22222]
- Links to documentation in the Admin UI are
  updated to point to the docs for version 2.0. [#21894][#21894]

### Bug Fixes

- Fix a panic with certain queries involving
  REGCLASS [#22310][#22310]
- Fix behaviour and types of ENCODE and DECODE. [#22230][#22230]
- passing the same tuple for `FROM` and `TO` in
    `ALTER TABLE ... SCATTER` now works [#21830][#21830]
- fixed a regression which caused certain
  queries using LIKE or SIMILAR TO with an indexed column to be slow. [#21842][#21842]
- fix a stack overflow in the code for shutting
  down a server when out of disk space [#21768][#21768]
- Fix Windows release builds. [#21793][#21793]
- fixed an issue with the wire-formatting of BYTES
  arrays. [#21712][#21712]
- fixed a bug that could lead to a crash (which in
  turn would require that the node be reinitialized). [#21771][#21771]

### Performance Improvements

- Reduced disruption from nodes
  recovering from network partitions. [#22316][#22316]
- improve performance of scans by
  copying less data in memory.

  Co-authored-by: Jordan Lewis <jordanthelewis@gmail.com>
  Co-authored-by: Peter Mattis <petermattis@gmail.com> [#22309][#22309]
- improve performance of scans by
  copying less data in memory.

  Co-authored-by: Jordan Lewis <jordanthelewis@gmail.com>
  Co-authored-by: Peter Mattis <petermattis@gmail.com> [#22245][#22245]
- Small performance improvement to
  low-level scan operations. [#22244][#22244]
- Writes will now be backpressured
  when ranges grow to large until the range is successfully able to split.
  This prevents unbounded range growth and improves a clusters ability to
  stay healthy under hotspot workloads. [#21777][#21777]
- information_schema and
  pg_catalog should be faster to query. [#21609][#21609]
- reduce write amplification of
  Raft replication. [#20647][#20647]

### Miscellaneous

#### Admin Ui

- Added raft snapshot queue metrics to Queue
  dashboard. [#22210][#22210]

#### Missing Category

- the results for database creation, dropping or renaming
  statement are now block only delivered to the client once it's
  guaranteed that the client in question can use the new database (or the
  new name of the database). [#21900][#21900]
- Fixed a bug where healthy nodes could appear as "Suspect"
  in the Admin UI if the web browser's local clock was skewed. [#22237][#22237]

#### Changes without release note annotation

- [#22319][#22319] [08d2bc925][08d2bc925] opt: Infer types for opt scalar expressions. (Andrew Kimball)
- [#22278][#22278] [fdf469e3f][fdf469e3f] storage/engine: remove support for pre-go1.9 (Peter Mattis)
- [#20290][#20290] [aa1fc8064][aa1fc8064] sqlbase: clarify how we reuse table names (Vivek Menezes)
- [#21777][#21777] [ab7d64554][ab7d64554] storage: backpressure writes for large ranges until they split (Nathan VanBenschoten)
- [#21847][#21847] [5f7947d83][5f7947d83] opt: Add optgen code generation tool. (Andrew Kimball)
- [#21754][#21754] [b512940f1][b512940f1] storage: adjust options for manual RocksDB compaction (Spencer Kimball)
- [#21816][#21816] [014af6b64][014af6b64] scripts: make the release note extraction script search for common parent (Raphael 'kena' Poss)

### Doc Updates

Docs team: Please add these manually.

### Contributors

This release includes 133 merged PRs by 28 authors. We would like to thank the following contributors from the CockroachDB community, with special thanks to first-time contributors pocockn.
- pocockn

[#19306]: https://github.com/cockroachdb/cockroach/pull/19306
[#20290]: https://github.com/cockroachdb/cockroach/pull/20290
[#20450]: https://github.com/cockroachdb/cockroach/pull/20450
[#20647]: https://github.com/cockroachdb/cockroach/pull/20647
[#21140]: https://github.com/cockroachdb/cockroach/pull/21140
[#21609]: https://github.com/cockroachdb/cockroach/pull/21609
[#21684]: https://github.com/cockroachdb/cockroach/pull/21684
[#21712]: https://github.com/cockroachdb/cockroach/pull/21712
[#21716]: https://github.com/cockroachdb/cockroach/pull/21716
[#21754]: https://github.com/cockroachdb/cockroach/pull/21754
[#21767]: https://github.com/cockroachdb/cockroach/pull/21767
[#21768]: https://github.com/cockroachdb/cockroach/pull/21768
[#21771]: https://github.com/cockroachdb/cockroach/pull/21771
[#21774]: https://github.com/cockroachdb/cockroach/pull/21774
[#21777]: https://github.com/cockroachdb/cockroach/pull/21777
[#21778]: https://github.com/cockroachdb/cockroach/pull/21778
[#21780]: https://github.com/cockroachdb/cockroach/pull/21780
[#21793]: https://github.com/cockroachdb/cockroach/pull/21793
[#21799]: https://github.com/cockroachdb/cockroach/pull/21799
[#21816]: https://github.com/cockroachdb/cockroach/pull/21816
[#21820]: https://github.com/cockroachdb/cockroach/pull/21820
[#21829]: https://github.com/cockroachdb/cockroach/pull/21829
[#21830]: https://github.com/cockroachdb/cockroach/pull/21830
[#21842]: https://github.com/cockroachdb/cockroach/pull/21842
[#21847]: https://github.com/cockroachdb/cockroach/pull/21847
[#21859]: https://github.com/cockroachdb/cockroach/pull/21859
[#21864]: https://github.com/cockroachdb/cockroach/pull/21864
[#21894]: https://github.com/cockroachdb/cockroach/pull/21894
[#21900]: https://github.com/cockroachdb/cockroach/pull/21900
[#22205]: https://github.com/cockroachdb/cockroach/pull/22205
[#22210]: https://github.com/cockroachdb/cockroach/pull/22210
[#22217]: https://github.com/cockroachdb/cockroach/pull/22217
[#22218]: https://github.com/cockroachdb/cockroach/pull/22218
[#22220]: https://github.com/cockroachdb/cockroach/pull/22220
[#22221]: https://github.com/cockroachdb/cockroach/pull/22221
[#22222]: https://github.com/cockroachdb/cockroach/pull/22222
[#22230]: https://github.com/cockroachdb/cockroach/pull/22230
[#22237]: https://github.com/cockroachdb/cockroach/pull/22237
[#22244]: https://github.com/cockroachdb/cockroach/pull/22244
[#22245]: https://github.com/cockroachdb/cockroach/pull/22245
[#22278]: https://github.com/cockroachdb/cockroach/pull/22278
[#22284]: https://github.com/cockroachdb/cockroach/pull/22284
[#22309]: https://github.com/cockroachdb/cockroach/pull/22309
[#22310]: https://github.com/cockroachdb/cockroach/pull/22310
[#22314]: https://github.com/cockroachdb/cockroach/pull/22314
[#22316]: https://github.com/cockroachdb/cockroach/pull/22316
[#22319]: https://github.com/cockroachdb/cockroach/pull/22319
[#22325]: https://github.com/cockroachdb/cockroach/pull/22325
[#22326]: https://github.com/cockroachdb/cockroach/pull/22326
[#22327]: https://github.com/cockroachdb/cockroach/pull/22327
[#22338]: https://github.com/cockroachdb/cockroach/pull/22338
[b512940f1]: https://github.com/cockroachdb/cockroach/commit/b512940f1
[fdf469e3f]: https://github.com/cockroachdb/cockroach/commit/fdf469e3f
[ab7d64554]: https://github.com/cockroachdb/cockroach/commit/ab7d64554
[014af6b64]: https://github.com/cockroachdb/cockroach/commit/014af6b64
[08d2bc925]: https://github.com/cockroachdb/cockroach/commit/08d2bc925
[5f7947d83]: https://github.com/cockroachdb/cockroach/commit/5f7947d83
[aa1fc8064]: https://github.com/cockroachdb/cockroach/commit/aa1fc8064
